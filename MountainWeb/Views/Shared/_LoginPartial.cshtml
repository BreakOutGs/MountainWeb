@using Microsoft.AspNetCore.Identity
@using MountainWeb.Data.Entities;
@using MountainWeb.Data;
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager
@inject ApplicationDbContext _context

<script type="text/javascript" src="~/lib/jquery/dist/jquery.js"></script>
<script>
    var RemindList;
    function getReminds(){
        $.ajax({
            type: "Post",
            url: "@Url.Action("GetReminds", "Reminds")",
            data: {},
            dataType: "json",
            success: function (msg) {

                RemindList = msg;

                console.log(msg);
            },
            error: function (req, status, error) {
                console.log(error);
            }
        });
    }
    $(document).ready(function(){
       
            window.addEventListener("click", function () {
                $("#ProfileMenu").removeClass("Mountain-WsContActive");
            });
            $("#ProfileMenuButton").click(function (event) {
                event.stopPropagation();
                $(".Mountain-WsContMenu").removeClass("Mountain-WsContActive");
                $("#ProfileMenu").addClass("Mountain-WsContActive");

                var x = this.offsetLeft + 20;
                var y = this.offsetTop+35;
                $("#ProfileMenu").css({ left: x, top: y });
            });
    });
</script>

<ul class="navbar-nav">
    @if (User.IsInRole("Admin"))
    {
        <li class="nav-item">
            <a class="nav-link text-dark" asp-area="" asp-controller="AdminPanel" asp-action="Index">Адмінка</a>
        </li>
    }
    @if (SignInManager.IsSignedIn(User))
    {

        <li class="nav-item M-navbaritem">
            <a class="nav-link text-dark" asp-area="" asp-controller="Workspace" asp-action="Index">Робоче місце</a>
        </li>
        <li>
            <div>
                <button class="fa-stack M-HButton Mountain-ContextMenuButton" style="color:black" id="ProfileMenuButton">
                    <img src="~/uploads/avatar/@_context.Users.Single(u=>u.Id==UserManager.GetUserId(User)).AvatarPath" class="M-ProfileIcon" />
                    <i class="fas fa-sort-down"></i>
                </button>
                <div class="Mountain-WsContMenu" id="ProfileMenu">

                    <div class="item">
                        <a class="" asp-action="Index" asp-controller="User">Профіль</a>
                    </div>

                    <div class="item">
                        <form asp-area="Identity" asp-page="/Account/Logout" asp-route-returnUrl="@Url.Action("Index", "Home", new { area = "" })">
                            <button type="submit" class="btn btn-link">Вийти</button>
                        </form>
                    </div>

                </div>
            </div>
        </li>
      
       



    }
    else
    {
        <li class="nav-item M-navbaritem">
            <a class="nav-link text-dark" asp-area="Identity" asp-page="/Account/Register">Реєстрація</a>
        </li>
        <li class="nav-item M-navbaritem">
            <a class="nav-link text-dark" asp-area="Identity" asp-page="/Account/Login">Вхід</a>
        </li>
    }
</ul>
<div style="display:none" class="RemindTabs">
    <button type="button" onclick="OpenTab('PastRemind')" id="DefaultTab">Сповіщення</button>
    <button type="button">Очікується</button>
    <div id="PastReminds" class="Mountain-RemTabContent">

    </div>
    <div id="FutureReminds" class="Mountain-RemTabContent">

    </div>
</div>
